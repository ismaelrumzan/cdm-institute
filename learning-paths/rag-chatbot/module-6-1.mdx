---
title: "6.1 Chat Interface Setup"
description: "Set up the chat interface with AI SDK, create message components, and implement form handling with proper validation."
---

## Learning Objectives

By the end of this section, you will be able to:

- Set up the chat interface using AI SDK's useChat hook
- Create responsive message components for different message types
- Implement form handling with proper validation
- Design an intuitive user experience for the chat interface

<Callout>**Duration**: 35 minutes</Callout>

---

## AI SDK Chat Integration

### Understanding useChat Hook

<Callout type="info">
  **useChat Hook**: AI SDK's React hook for managing chat state and interactions
</Callout>

<Callout type="info">
  **Real-time Streaming**: Built-in support for streaming responses from AI
  models
</Callout>

<Callout type="info">
  **State Management**: Automatic handling of messages, loading states, and
  errors
</Callout>

### Basic Chat Setup

<CodeGroup>
  <CodeGroupItem title="Actual Implementation from Repository">
```typescript
// app/page.tsx
"use client";

import { useChat } from "@ai-sdk/react";
import { useState } from "react";

export default function Chat() {
  const [input, setInput] = useState("");
  const { messages, sendMessage, isLoading } = useChat();

const handleSubmit = (e: React.FormEvent) => {
e.preventDefault();
if (input.trim()) {
sendMessage({ text: input });
setInput("");
}
};

return (

<div className="flex flex-col w-full max-w-4xl mx-auto h-screen">
<div className="flex-1 overflow-y-auto p-4 space-y-4">
{messages.map((message) => (
<div
key={message.id}
className={`flex ${
              message.role === "user" ? "justify-end" : "justify-start"
            }`} >
<div
className={`max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${
                message.role === "user"
                  ? "bg-blue-500 text-white"
                  : "bg-gray-200 text-gray-800"
              }`} >
<div className="text-sm font-semibold mb-1">
{message.role === "user" ? "You" : "Assistant"}
</div>
<div className="whitespace-pre-wrap">
{message.parts.map((part) => {
if (part.type === "text") {
return <span key={part.id}>{part.text}</span>;
}
return null;
})}
</div>
</div>
</div>
))}

        {isLoading && (
          <div className="flex justify-start">
            <div className="bg-gray-200 text-gray-800 px-4 py-2 rounded-lg">
              <div className="text-sm font-semibold mb-1">Assistant</div>
              <div>Thinking...</div>
            </div>
          </div>
        )}
      </div>

      <form onSubmit={handleSubmit} className="p-4 border-t">
        <div className="flex space-x-2">
          <input
            value={input}
            onChange={(e) => setInput(e.target.value)}
            placeholder="Say something..."
            className="flex-1 p-2 border border-gray-300 rounded"
            disabled={isLoading}
          />
          <button
            type="submit"
            disabled={isLoading || !input.trim()}
            className="px-4 py-2 bg-blue-500 text-white rounded disabled:opacity-50"
          >
            Send
          </button>
        </div>
      </form>
    </div>

);
}

````
  </CodeGroupItem>
  <CodeGroupItem title="Enhanced with Configuration">
```typescript
// components/chat.tsx
'use client'

import { useChat } from 'ai/react'

export function Chat() {
  const {
    messages,
    input,
    handleInputChange,
    handleSubmit,
    isLoading,
    error,
    append,
    reload,
    stop
  } = useChat({
    api: '/api/chat',
    initialMessages: [
      {
        id: 'welcome',
        role: 'assistant',
        content: 'Hello! I\'m your RAG assistant. I can help you find information from your knowledge base. What would you like to know?'
      }
    ],
    onError: (error) => {
      console.error('Chat error:', error)
    },
    onFinish: (message) => {
      console.log('Chat finished:', message)
    }
  })

  return (
    <div className="flex flex-col h-screen max-w-4xl mx-auto">
      <div className="flex-1 overflow-y-auto p-4 space-y-4">
        {messages.map((message) => (
          <MessageComponent key={message.id} message={message} />
        ))}

        {isLoading && (
          <div className="flex items-center space-x-2 text-gray-500">
            <div className="animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"></div>
            <span>AI is thinking...</span>
          </div>
        )}

        {error && (
          <div className="bg-red-50 border border-red-200 rounded p-3 text-red-700">
            Error: {error.message}
          </div>
        )}
      </div>

      <ChatInput
        input={input}
        handleInputChange={handleInputChange}
        handleSubmit={handleSubmit}
        isLoading={isLoading}
        onStop={stop}
      />
    </div>
  )
}
````

  </CodeGroupItem>
</CodeGroup>

---

## Message Components

### Different Message Types

<CodeGroup>
  <CodeGroupItem title="Message Component">
```typescript
// components/message.tsx
'use client'

import { Message } from "ai";
import { UserMessage } from "./user-message";
import { AssistantMessage } from "./assistant-message";
import { SystemMessage } from "./system-message";

interface MessageComponentProps {
message: Message
}

export function MessageComponent({ message }: MessageComponentProps) {
  switch (message.role) {
    case 'user':
      return <UserMessage message={message} />
    case 'assistant':
      return <AssistantMessage message={message} />
    case 'system':
      return <SystemMessage message={message} />
    default:
      return <div>Unknown message type</div>
  }
}
```
  </CodeGroupItem>
  <CodeGroupItem title="User Message Component">
```typescript
// components/user-message.tsx
'use client'

import { Message } from 'ai'
import { User } from 'lucide-react'

interface UserMessageProps {
message: Message
}

export function UserMessage({ message }: UserMessageProps) {
  return (
    <div className="flex justify-end mb-4">
      <div className="flex items-start space-x-2 max-w-[80%]">
        <div className="bg-blue-500 text-white rounded-lg px-4 py-2 shadow-sm">
          <p className="text-sm">{message.content}</p>
        </div>
        <div className="flex-shrink-0">
          <div className="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center">
            <User className="w-4 h-4 text-white" />
          </div>
        </div>
      </div>
    </div>
  )
}
```
  </CodeGroupItem>
</CodeGroup>

### Assistant Message with Streaming

<CodeGroup>
  <CodeGroupItem title="Assistant Message">
```typescript
// components/assistant-message.tsx
'use client'

import { Message } from "ai";
import { Bot } from "lucide-react";
import { useState } from "react";

interface AssistantMessageProps {
message: Message
}

export function AssistantMessage({ message }: AssistantMessageProps) {
  const [isExpanded, setIsExpanded] = useState(false)

return (

<div className="flex justify-start mb-4">
  <div className="flex items-start space-x-2 max-w-[80%]">
    <div className="flex-shrink-0">
      <div className="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center">
        <Bot className="w-4 h-4 text-white" />
      </div>
    </div>
    <div className="bg-gray-100 rounded-lg px-4 py-2 shadow-sm">
      <div className="prose prose-sm max-w-none">
        {message.content.length > 200 && !isExpanded ? (
          <div>
            <p>{message.content.slice(0, 200)}...</p>
            <button
              onClick={() => setIsExpanded(true)}
              className="text-blue-500 text-sm hover:underline">
              Read more
            </button>
          </div>
        ) : (
          <div>
            <p>{message.content}</p>
            {isExpanded && (
              <button
                onClick={() => setIsExpanded(false)}
                className="text-blue-500 text-sm hover:underline">
                Show less
              </button>
            )}
          </div>
        )}
      </div>
      <div className="text-xs text-gray-500 mt-2">
        {new Date(message.createdAt || Date.now()).toLocaleTimeString()}
      </div>
    </div>
  </div>
</div>
) }

````
  </CodeGroupItem>
  <CodeGroupItem title="System Message">
```typescript
// components/system-message.tsx
'use client'

import { Message } from 'ai'
import { Info } from 'lucide-react'

interface SystemMessageProps {
  message: Message
}

export function SystemMessage({ message }: SystemMessageProps) {
  return (
    <div className="flex justify-center mb-4">
      <div className="flex items-center space-x-2 bg-yellow-50 border border-yellow-200 rounded-lg px-3 py-2">
        <Info className="w-4 h-4 text-yellow-600" />
        <span className="text-sm text-yellow-800">{message.content}</span>
      </div>
    </div>
  )
}
````

  </CodeGroupItem>
</CodeGroup>

---

## Chat Input Component

### Enhanced Input Handling

<CodeGroup>
  <CodeGroupItem title="Basic Chat Input">
```typescript
// components/chat-input.tsx
'use client'

import { useState, useRef, useEffect } from "react";
import { Send, StopCircle } from "lucide-react";

interface ChatInputProps {
input: string
handleInputChange: (e: React.ChangeEvent<HTMLTextAreaElement>) => void
handleSubmit: (e: React.FormEvent<HTMLFormElement>) => void
isLoading: boolean
onStop?: () => void
}

export function ChatInput({
  input,
  handleInputChange,
  handleSubmit,
  isLoading,
  onStop
}: ChatInputProps) {
  const textareaRef = useRef<HTMLTextAreaElement>(null)

// Auto-resize textarea
useEffect(() => {
if (textareaRef.current) {
textareaRef.current.style.height = 'auto'
textareaRef.current.style.height = `${textareaRef.current.scrollHeight}px`
}
}, [input])

// Handle Enter key (submit) and Shift+Enter (new line)
const handleKeyDown = (e: React.KeyboardEvent) => {
if (e.key === 'Enter' && !e.shiftKey) {
e.preventDefault()
if (input.trim() && !isLoading) {
const form = e.currentTarget.closest('form')
form?.requestSubmit()
}
}
}

return (

<div className="border-t bg-white p-4">
<form onSubmit={handleSubmit} className="flex space-x-2">
<div className="flex-1 relative">
<textarea
            ref={textareaRef}
            value={input}
            onChange={handleInputChange}
            onKeyDown={handleKeyDown}
            placeholder="Ask a question about your knowledge base..."
            disabled={isLoading}
            className="w-full p-3 border border-gray-300 rounded-lg resize-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"
            rows={1}
            maxLength={2000}
          />
<div className="absolute bottom-2 right-2 text-xs text-gray-400">
{input.length}/2000
</div>
</div>

        <div className="flex space-x-2">
          {isLoading && onStop ? (
            <button
              type="button"
              onClick={onStop}
              className="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors"
            >
              <StopCircle className="w-4 h-4" />
            </button>
          ) : (
            <button
              type="submit"
              disabled={isLoading || !input.trim()}
              className="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
            >
              <Send className="w-4 h-4" />
            </button>
          )}
        </div>
      </form>
    </div>

)
}

````
  </CodeGroupItem>
  <CodeGroupItem title="Advanced Input with Validation">
```typescript
// components/advanced-chat-input.tsx
'use client'

import { useState, useRef, useEffect } from 'react'
import { Send, StopCircle, Paperclip, Smile } from 'lucide-react'

interface AdvancedChatInputProps {
  input: string
  handleInputChange: (e: React.ChangeEvent<HTMLTextAreaElement>) => void
  handleSubmit: (e: React.FormEvent<HTMLFormElement>) => void
  isLoading: boolean
  onStop?: () => void
  onFileUpload?: (file: File) => void
}

export function AdvancedChatInput({
  input,
  handleInputChange,
  handleSubmit,
  isLoading,
  onStop,
  onFileUpload
}: AdvancedChatInputProps) {
  const [validationError, setValidationError] = useState<string>('')
  const fileInputRef = useRef<HTMLInputElement>(null)
  const textareaRef = useRef<HTMLTextAreaElement>(null)

  // Validate input
  useEffect(() => {
    if (input.length > 2000) {
      setValidationError('Message too long (max 2000 characters)')
    } else if (input.trim().length === 0) {
      setValidationError('')
    } else {
      setValidationError('')
    }
  }, [input])

  // Auto-resize textarea
  useEffect(() => {
    if (textareaRef.current) {
      textareaRef.current.style.height = 'auto'
      textareaRef.current.style.height = `${Math.min(textareaRef.current.scrollHeight, 200)}px`
    }
  }, [input])

  const handleKeyDown = (e: React.KeyboardEvent) => {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault()
      if (input.trim() && !isLoading && !validationError) {
        const form = e.currentTarget.closest('form')
        form?.requestSubmit()
      }
    }
  }

  const handleFileUpload = (e: React.ChangeEvent<HTMLInputElement>) => {
    const file = e.target.files?.[0]
    if (file && onFileUpload) {
      onFileUpload(file)
    }
  }

  const isSubmitDisabled = isLoading || !input.trim() || !!validationError

  return (
    <div className="border-t bg-white p-4">
      <form onSubmit={handleSubmit} className="space-y-2">
        <div className="flex space-x-2">
          <div className="flex-1 relative">
            <textarea
              ref={textareaRef}
              value={input}
              onChange={handleInputChange}
              onKeyDown={handleKeyDown}
              placeholder="Ask a question about your knowledge base..."
              disabled={isLoading}
              className={`w-full p-3 border rounded-lg resize-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50 ${
                validationError ? 'border-red-300' : 'border-gray-300'
              }`}
              rows={1}
              maxLength={2000}
            />
            <div className="absolute bottom-2 right-2 text-xs text-gray-400">
              {input.length}/2000
            </div>
          </div>

          <div className="flex space-x-2">
            {onFileUpload && (
              <button
                type="button"
                onClick={() => fileInputRef.current?.click()}
                disabled={isLoading}
                className="px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 transition-colors"
              >
                <Paperclip className="w-4 h-4" />
              </button>
            )}

            <button
              type="button"
              disabled={isLoading}
              className="px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 transition-colors"
            >
              <Smile className="w-4 h-4" />
            </button>

            {isLoading && onStop ? (
              <button
                type="button"
                onClick={onStop}
                className="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors"
              >
                <StopCircle className="w-4 h-4" />
              </button>
            ) : (
              <button
                type="submit"
                disabled={isSubmitDisabled}
                className="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
              >
                <Send className="w-4 h-4" />
              </button>
            )}
          </div>
        </div>

        {validationError && (
          <div className="text-red-500 text-sm">{validationError}</div>
        )}

        {onFileUpload && (
          <input
            ref={fileInputRef}
            type="file"
            onChange={handleFileUpload}
            className="hidden"
            accept=".txt,.pdf,.doc,.docx"
          />
        )}
      </form>
    </div>
  )
}
````

  </CodeGroupItem>
</CodeGroup>

---

## UI Components with shadcn-ui

### Styled Components

<CodeGroup>
  <CodeGroupItem title="Chat Container">
```typescript
// components/chat-container.tsx
'use client'

import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { ScrollArea } from "@/components/ui/scroll-area";
import { Separator } from "@/components/ui/separator";

interface ChatContainerProps {
children: React.ReactNode
title?: string
}

export function ChatContainer({ children, title = "RAG Chat Assistant" }: ChatContainerProps) {
  return (
    <Card className="h-screen max-w-4xl mx-auto flex flex-col">
      <CardHeader className="border-b">
        <CardTitle className="flex items-center space-x-2">
          <div className="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center">
            <span className="text-white font-bold">R</span>
          </div>
          <span>{title}</span>
        </CardTitle>
      </CardHeader>
      
      <CardContent className="flex-1 p-0">
        <ScrollArea className="h-full">
          <div className="p-4">
            {children}
          </div>
        </ScrollArea>
      </CardContent>
    </Card>
  )
}
```
  </CodeGroupItem>
  <CodeGroupItem title="Message Bubble">
```typescript
// components/message-bubble.tsx
'use client'

import { cn } from '@/lib/utils'
import { Badge } from '@/components/ui/badge'
import { Button } from '@/components/ui/button'
import { Copy, Check } from 'lucide-react'
import { useState } from 'react'

interface MessageBubbleProps {
content: string
role: 'user' | 'assistant' | 'system'
timestamp?: Date
className?: string
}

export function MessageBubble({ 
  content, 
  role, 
  timestamp, 
  className 
}: MessageBubbleProps) {
  const [copied, setCopied] = useState(false)

const copyToClipboard = async () => {
try {
await navigator.clipboard.writeText(content)
setCopied(true)
setTimeout(() => setCopied(false), 2000)
} catch (error) {
console.error('Failed to copy:', error)
}
}

const isUser = role === 'user'
const isSystem = role === 'system'

if (isSystem) {
return (

<div className="flex justify-center my-4">
  <Badge variant="secondary" className="text-xs">
    {content}
  </Badge>
</div>
) }

return (

<div className={cn(
"flex mb-4",
isUser ? "justify-end" : "justify-start"
)}>
<div className={cn(
"flex items-start space-x-2 max-w-[80%]",
isUser && "flex-row-reverse space-x-reverse"
)}>
<div className={cn(
"rounded-lg px-4 py-2 shadow-sm",
isUser
? "bg-blue-500 text-white"
: "bg-gray-100 text-gray-900"
)}>
<div className="prose prose-sm max-w-none">
<p className="whitespace-pre-wrap">{content}</p>
</div>

          {timestamp && (
            <div className={cn(
              "text-xs mt-2",
              isUser ? "text-blue-100" : "text-gray-500"
            )}>
              {timestamp.toLocaleTimeString()}
            </div>
          )}
        </div>

        {!isUser && (
          <Button
            variant="ghost"
            size="sm"
            onClick={copyToClipboard}
            className="opacity-0 group-hover:opacity-100 transition-opacity"
          >
            {copied ? (
              <Check className="w-3 h-3" />
            ) : (
              <Copy className="w-3 h-3" />
            )}
          </Button>
        )}
      </div>
    </div>

)
}

````
  </CodeGroupItem>
</CodeGroup>

---

## Complete Chat Interface

### Integrated Chat Component

<CodeGroup>
  <CodeGroupItem title="Complete Chat Interface">
```typescript
// components/complete-chat.tsx
'use client'

import { useChat } from 'ai/react'
import { ChatContainer } from './chat-container'
import { MessageBubble } from './message-bubble'
import { AdvancedChatInput } from './advanced-chat-input'
import { Alert, AlertDescription } from '@/components/ui/alert'
import { Loader2, AlertCircle } from 'lucide-react'

export function CompleteChat() {
  const {
    messages,
    input,
    handleInputChange,
    handleSubmit,
    isLoading,
    error,
    stop
  } = useChat({
    api: '/api/chat',
    initialMessages: [
      {
        id: 'welcome',
        role: 'assistant',
        content: 'Hello! I\'m your RAG assistant. I can help you find information from your knowledge base. What would you like to know?'
      }
    ],
    onError: (error) => {
      console.error('Chat error:', error)
    }
  })

  return (
    <ChatContainer>
      <div className="flex flex-col h-full">
        {/* Messages Area */}
        <div className="flex-1 overflow-y-auto space-y-4 group">
          {messages.map((message) => (
            <MessageBubble
              key={message.id}
              content={message.content}
              role={message.role}
              timestamp={message.createdAt ? new Date(message.createdAt) : undefined}
            />
          ))}

          {isLoading && (
            <div className="flex items-center space-x-2 text-gray-500">
              <Loader2 className="w-4 h-4 animate-spin" />
              <span>AI is thinking...</span>
            </div>
          )}
        </div>

        {/* Error Display */}
        {error && (
          <Alert variant="destructive" className="mb-4">
            <AlertCircle className="h-4 w-4" />
            <AlertDescription>
              Error: {error.message}
            </AlertDescription>
          </Alert>
        )}

        {/* Input Area */}
        <AdvancedChatInput
          input={input}
          handleInputChange={handleInputChange}
          handleSubmit={handleSubmit}
          isLoading={isLoading}
          onStop={stop}
        />
      </div>
    </ChatContainer>
  )
}
````

  </CodeGroupItem>
  <CodeGroupItem title="Page Integration">
```typescript
// app/chat/page.tsx
import { CompleteChat } from '@/components/complete-chat'

export default function ChatPage() {
  return (
    <div className="min-h-screen bg-gray-50">
      <CompleteChat />
    </div>
  )
}
```
  </CodeGroupItem>
</CodeGroup>

---

## Interactive Elements

### Chat Interface Testing Checklist

<Callout type="info">
  **Complete this checklist to verify your chat interface**: ✅ useChat hook is
  properly configured ✅ Messages display correctly for all types ✅ Input
  validation works properly ✅ Auto-resize textarea functions ✅ Keyboard
  shortcuts work (Enter to send, Shift+Enter for new line) ✅ Loading states are
  displayed ✅ Error handling shows user-friendly messages ✅ Stop functionality
  works during streaming ✅ Responsive design works on mobile ✅ Accessibility
  features are implemented
</Callout>

### User Experience Testing

<Callout type="info">
  **Test these user experience scenarios**: 1. Send a simple message and verify
  response 2. Test with long messages and verify textarea resizing 3. Test
  keyboard shortcuts and form submission 4. Verify loading states and error
  handling 5. Test on different screen sizes 6. Check accessibility with screen
  readers 7. Test copy functionality for assistant messages 8. Verify timestamp
  display and formatting
</Callout>

---

## Troubleshooting Common Issues

<Callout type="warning">
  **Issue**: useChat hook not working **Solution**: Verify API route exists at
  /api/chat and AI SDK is properly installed
</Callout>

<Callout type="warning">
  **Issue**: Messages not displaying **Solution**: Check message component props
  and ensure proper role handling
</Callout>

<Callout type="warning">
  **Issue**: Input not working **Solution**: Verify form handling and event
  propagation
</Callout>

<Callout type="warning">
  **Issue**: Styling issues **Solution**: Ensure TailwindCSS is configured and
  shadcn-ui components are installed
</Callout>

---

## Reflection Questions

Take a moment to reflect on what you've learned:

1. **How does the useChat hook simplify chat interface development?**

   - Consider state management and real-time updates
   - Think about error handling and loading states

2. **What are the key considerations for designing a good chat interface?**

   - Consider user experience and accessibility
   - Think about responsive design and mobile usage

3. **How would you enhance the chat interface for your specific use case?**
   - Consider additional features like file uploads or message reactions
   - Think about customization and branding

---

## Next Steps

You've set up the chat interface! In the next section, you'll:

- **Implement real-time streaming** for better user experience
- **Add loading states and error handling** for robust interactions
- **Enhance the UI/UX** with advanced features

Ready to continue? Proceed to [Section 6.2: Real-time Streaming](/learning-paths/rag-chatbot/module-6-2).

<Callout>
  **Key Takeaway**: A well-designed chat interface with proper AI SDK
  integration provides the foundation for an engaging RAG application user
  experience.
</Callout>
